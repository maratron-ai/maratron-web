dc639ba21b8c007417099d6f9d2514bc
"use strict";

var _analytics = require("../analytics");
describe('calculateAnalytics', () => {
  const sampleRuns = [{
    id: '1',
    date: new Date('2024-01-01'),
    duration: '30:00',
    distance: 5,
    distanceUnit: 'miles',
    userId: 'user1'
  }, {
    id: '2',
    date: new Date('2024-01-03'),
    duration: '45:00',
    distance: 7,
    distanceUnit: 'miles',
    userId: 'user1'
  }, {
    id: '3',
    date: new Date('2024-01-05'),
    duration: '20:00',
    distance: 3,
    distanceUnit: 'miles',
    userId: 'user1'
  }];
  it('calculates basic stats correctly', () => {
    const analytics = (0, _analytics.calculateAnalytics)(sampleRuns);
    expect(analytics.totalRuns).toBe(3);
    expect(analytics.totalDistance).toBe(15);
    expect(analytics.totalTime).toBe(95); // 30 + 45 + 20 minutes
    expect(analytics.longestRun).toBe(7);
    expect(analytics.weeklyDistanceChart).toBeDefined();
    expect(analytics.cumulativeDistance).toBeDefined();
  });
  it('calculates average pace correctly', () => {
    const analytics = (0, _analytics.calculateAnalytics)(sampleRuns);

    // 95 minutes / 15 miles = 6.33 minutes per mile = 6:20
    expect(analytics.averagePace).toBe('6:20');
  });
  it('handles empty runs array', () => {
    const analytics = (0, _analytics.calculateAnalytics)([]);
    expect(analytics.totalRuns).toBe(0);
    expect(analytics.totalDistance).toBe(0);
    expect(analytics.totalTime).toBe(0);
    expect(analytics.averagePace).toBe('0:00');
    expect(analytics.longestRun).toBe(0);
    expect(analytics.weeklyAverage).toBe(0);
    expect(analytics.weeklyDistanceChart).toEqual([]);
    expect(analytics.cumulativeDistance).toEqual([]);
  });
  it('converts kilometers to miles', () => {
    const kmRuns = [{
      id: '1',
      date: new Date('2024-01-01'),
      duration: '30:00',
      distance: 8,
      // 8 km = ~4.97 miles
      distanceUnit: 'kilometers',
      userId: 'user1'
    }];
    const analytics = (0, _analytics.calculateAnalytics)(kmRuns);
    expect(analytics.totalDistance).toBeCloseTo(4.97, 1);
  });
  it('calculates distance distribution correctly', () => {
    const analytics = (0, _analytics.calculateAnalytics)(sampleRuns);
    const distribution = analytics.distanceDistribution;
    expect(distribution.find(d => d.range === '1-3 miles')?.count).toBe(1); // 3mi run
    expect(distribution.find(d => d.range === '3-5 miles')?.count).toBe(1); // 5mi run  
    expect(distribution.find(d => d.range === '5-10 miles')?.count).toBe(1); // 7mi run
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfYW5hbHl0aWNzIiwicmVxdWlyZSIsImRlc2NyaWJlIiwic2FtcGxlUnVucyIsImlkIiwiZGF0ZSIsIkRhdGUiLCJkdXJhdGlvbiIsImRpc3RhbmNlIiwiZGlzdGFuY2VVbml0IiwidXNlcklkIiwiaXQiLCJhbmFseXRpY3MiLCJjYWxjdWxhdGVBbmFseXRpY3MiLCJleHBlY3QiLCJ0b3RhbFJ1bnMiLCJ0b0JlIiwidG90YWxEaXN0YW5jZSIsInRvdGFsVGltZSIsImxvbmdlc3RSdW4iLCJ3ZWVrbHlEaXN0YW5jZUNoYXJ0IiwidG9CZURlZmluZWQiLCJjdW11bGF0aXZlRGlzdGFuY2UiLCJhdmVyYWdlUGFjZSIsIndlZWtseUF2ZXJhZ2UiLCJ0b0VxdWFsIiwia21SdW5zIiwidG9CZUNsb3NlVG8iLCJkaXN0cmlidXRpb24iLCJkaXN0YW5jZURpc3RyaWJ1dGlvbiIsImZpbmQiLCJkIiwicmFuZ2UiLCJjb3VudCJdLCJzb3VyY2VzIjpbImFuYWx5dGljcy50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNhbGN1bGF0ZUFuYWx5dGljcyB9IGZyb20gJy4uL2FuYWx5dGljcyc7XG5pbXBvcnQgdHlwZSB7IFJ1biB9IGZyb20gJ0BtYXJhdHlwZXMvcnVuJztcblxuZGVzY3JpYmUoJ2NhbGN1bGF0ZUFuYWx5dGljcycsICgpID0+IHtcbiAgY29uc3Qgc2FtcGxlUnVuczogUnVuW10gPSBbXG4gICAge1xuICAgICAgaWQ6ICcxJyxcbiAgICAgIGRhdGU6IG5ldyBEYXRlKCcyMDI0LTAxLTAxJyksXG4gICAgICBkdXJhdGlvbjogJzMwOjAwJyxcbiAgICAgIGRpc3RhbmNlOiA1LFxuICAgICAgZGlzdGFuY2VVbml0OiAnbWlsZXMnLFxuICAgICAgdXNlcklkOiAndXNlcjEnLFxuICAgIH0sXG4gICAge1xuICAgICAgaWQ6ICcyJyxcbiAgICAgIGRhdGU6IG5ldyBEYXRlKCcyMDI0LTAxLTAzJyksXG4gICAgICBkdXJhdGlvbjogJzQ1OjAwJyxcbiAgICAgIGRpc3RhbmNlOiA3LFxuICAgICAgZGlzdGFuY2VVbml0OiAnbWlsZXMnLFxuICAgICAgdXNlcklkOiAndXNlcjEnLFxuICAgIH0sXG4gICAge1xuICAgICAgaWQ6ICczJyxcbiAgICAgIGRhdGU6IG5ldyBEYXRlKCcyMDI0LTAxLTA1JyksXG4gICAgICBkdXJhdGlvbjogJzIwOjAwJyxcbiAgICAgIGRpc3RhbmNlOiAzLFxuICAgICAgZGlzdGFuY2VVbml0OiAnbWlsZXMnLFxuICAgICAgdXNlcklkOiAndXNlcjEnLFxuICAgIH0sXG4gIF07XG5cbiAgaXQoJ2NhbGN1bGF0ZXMgYmFzaWMgc3RhdHMgY29ycmVjdGx5JywgKCkgPT4ge1xuICAgIGNvbnN0IGFuYWx5dGljcyA9IGNhbGN1bGF0ZUFuYWx5dGljcyhzYW1wbGVSdW5zKTtcbiAgICBcbiAgICBleHBlY3QoYW5hbHl0aWNzLnRvdGFsUnVucykudG9CZSgzKTtcbiAgICBleHBlY3QoYW5hbHl0aWNzLnRvdGFsRGlzdGFuY2UpLnRvQmUoMTUpO1xuICAgIGV4cGVjdChhbmFseXRpY3MudG90YWxUaW1lKS50b0JlKDk1KTsgLy8gMzAgKyA0NSArIDIwIG1pbnV0ZXNcbiAgICBleHBlY3QoYW5hbHl0aWNzLmxvbmdlc3RSdW4pLnRvQmUoNyk7XG4gICAgZXhwZWN0KGFuYWx5dGljcy53ZWVrbHlEaXN0YW5jZUNoYXJ0KS50b0JlRGVmaW5lZCgpO1xuICAgIGV4cGVjdChhbmFseXRpY3MuY3VtdWxhdGl2ZURpc3RhbmNlKS50b0JlRGVmaW5lZCgpO1xuICB9KTtcblxuICBpdCgnY2FsY3VsYXRlcyBhdmVyYWdlIHBhY2UgY29ycmVjdGx5JywgKCkgPT4ge1xuICAgIGNvbnN0IGFuYWx5dGljcyA9IGNhbGN1bGF0ZUFuYWx5dGljcyhzYW1wbGVSdW5zKTtcbiAgICBcbiAgICAvLyA5NSBtaW51dGVzIC8gMTUgbWlsZXMgPSA2LjMzIG1pbnV0ZXMgcGVyIG1pbGUgPSA2OjIwXG4gICAgZXhwZWN0KGFuYWx5dGljcy5hdmVyYWdlUGFjZSkudG9CZSgnNjoyMCcpO1xuICB9KTtcblxuICBpdCgnaGFuZGxlcyBlbXB0eSBydW5zIGFycmF5JywgKCkgPT4ge1xuICAgIGNvbnN0IGFuYWx5dGljcyA9IGNhbGN1bGF0ZUFuYWx5dGljcyhbXSk7XG4gICAgXG4gICAgZXhwZWN0KGFuYWx5dGljcy50b3RhbFJ1bnMpLnRvQmUoMCk7XG4gICAgZXhwZWN0KGFuYWx5dGljcy50b3RhbERpc3RhbmNlKS50b0JlKDApO1xuICAgIGV4cGVjdChhbmFseXRpY3MudG90YWxUaW1lKS50b0JlKDApO1xuICAgIGV4cGVjdChhbmFseXRpY3MuYXZlcmFnZVBhY2UpLnRvQmUoJzA6MDAnKTtcbiAgICBleHBlY3QoYW5hbHl0aWNzLmxvbmdlc3RSdW4pLnRvQmUoMCk7XG4gICAgZXhwZWN0KGFuYWx5dGljcy53ZWVrbHlBdmVyYWdlKS50b0JlKDApO1xuICAgIGV4cGVjdChhbmFseXRpY3Mud2Vla2x5RGlzdGFuY2VDaGFydCkudG9FcXVhbChbXSk7XG4gICAgZXhwZWN0KGFuYWx5dGljcy5jdW11bGF0aXZlRGlzdGFuY2UpLnRvRXF1YWwoW10pO1xuICB9KTtcblxuICBpdCgnY29udmVydHMga2lsb21ldGVycyB0byBtaWxlcycsICgpID0+IHtcbiAgICBjb25zdCBrbVJ1bnM6IFJ1bltdID0gW1xuICAgICAge1xuICAgICAgICBpZDogJzEnLFxuICAgICAgICBkYXRlOiBuZXcgRGF0ZSgnMjAyNC0wMS0wMScpLFxuICAgICAgICBkdXJhdGlvbjogJzMwOjAwJyxcbiAgICAgICAgZGlzdGFuY2U6IDgsIC8vIDgga20gPSB+NC45NyBtaWxlc1xuICAgICAgICBkaXN0YW5jZVVuaXQ6ICdraWxvbWV0ZXJzJyxcbiAgICAgICAgdXNlcklkOiAndXNlcjEnLFxuICAgICAgfSxcbiAgICBdO1xuXG4gICAgY29uc3QgYW5hbHl0aWNzID0gY2FsY3VsYXRlQW5hbHl0aWNzKGttUnVucyk7XG4gICAgXG4gICAgZXhwZWN0KGFuYWx5dGljcy50b3RhbERpc3RhbmNlKS50b0JlQ2xvc2VUbyg0Ljk3LCAxKTtcbiAgfSk7XG5cbiAgaXQoJ2NhbGN1bGF0ZXMgZGlzdGFuY2UgZGlzdHJpYnV0aW9uIGNvcnJlY3RseScsICgpID0+IHtcbiAgICBjb25zdCBhbmFseXRpY3MgPSBjYWxjdWxhdGVBbmFseXRpY3Moc2FtcGxlUnVucyk7XG4gICAgXG4gICAgY29uc3QgZGlzdHJpYnV0aW9uID0gYW5hbHl0aWNzLmRpc3RhbmNlRGlzdHJpYnV0aW9uO1xuICAgIGV4cGVjdChkaXN0cmlidXRpb24uZmluZChkID0+IGQucmFuZ2UgPT09ICcxLTMgbWlsZXMnKT8uY291bnQpLnRvQmUoMSk7IC8vIDNtaSBydW5cbiAgICBleHBlY3QoZGlzdHJpYnV0aW9uLmZpbmQoZCA9PiBkLnJhbmdlID09PSAnMy01IG1pbGVzJyk/LmNvdW50KS50b0JlKDEpOyAvLyA1bWkgcnVuICBcbiAgICBleHBlY3QoZGlzdHJpYnV0aW9uLmZpbmQoZCA9PiBkLnJhbmdlID09PSAnNS0xMCBtaWxlcycpPy5jb3VudCkudG9CZSgxKTsgLy8gN21pIHJ1blxuICB9KTtcbn0pOyJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxJQUFBQSxVQUFBLEdBQUFDLE9BQUE7QUFHQUMsUUFBUSxDQUFDLG9CQUFvQixFQUFFLE1BQU07RUFDbkMsTUFBTUMsVUFBaUIsR0FBRyxDQUN4QjtJQUNFQyxFQUFFLEVBQUUsR0FBRztJQUNQQyxJQUFJLEVBQUUsSUFBSUMsSUFBSSxDQUFDLFlBQVksQ0FBQztJQUM1QkMsUUFBUSxFQUFFLE9BQU87SUFDakJDLFFBQVEsRUFBRSxDQUFDO0lBQ1hDLFlBQVksRUFBRSxPQUFPO0lBQ3JCQyxNQUFNLEVBQUU7RUFDVixDQUFDLEVBQ0Q7SUFDRU4sRUFBRSxFQUFFLEdBQUc7SUFDUEMsSUFBSSxFQUFFLElBQUlDLElBQUksQ0FBQyxZQUFZLENBQUM7SUFDNUJDLFFBQVEsRUFBRSxPQUFPO0lBQ2pCQyxRQUFRLEVBQUUsQ0FBQztJQUNYQyxZQUFZLEVBQUUsT0FBTztJQUNyQkMsTUFBTSxFQUFFO0VBQ1Ys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