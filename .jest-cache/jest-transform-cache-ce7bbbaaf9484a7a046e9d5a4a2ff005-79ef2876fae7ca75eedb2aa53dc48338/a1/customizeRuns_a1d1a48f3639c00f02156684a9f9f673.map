{"version":3,"names":["customizePlanRuns","plan","runsPerWeek","crossTrainingDays","Error","schedule","map","week","idx","runs","length","i","splice","type","unit","mileage","targetPace","pace","notes","_objectSpread","easyRuns","filter","r","longRun","find","tempoRun","intervalRun","push","alt3","alt2","longIndex","findIndex","insertAt","weeklyMileage","reduce","tot","replace","trim"],"sources":["customizeRuns.ts"],"sourcesContent":["import { RunningPlanData, PlannedRun } from \"@maratypes/runningPlan\";\n\nexport interface CustomizeOptions {\n  runsPerWeek: number;\n  crossTrainingDays?: number;\n}\n\nexport function customizePlanRuns(\n  plan: RunningPlanData,\n  { runsPerWeek, crossTrainingDays = 0 }: CustomizeOptions,\n): RunningPlanData {\n  if (runsPerWeek < 2 || runsPerWeek > 5) {\n    throw new Error(\"runsPerWeek must be between 2 and 5\");\n  }\n\n  if (crossTrainingDays < 0) {\n    throw new Error(\"crossTrainingDays cannot be negative\");\n  }\n\n  if (runsPerWeek + crossTrainingDays > 7) {\n    throw new Error(\"Total workout days cannot exceed 7 per week\");\n  }\n\n  const schedule = plan.schedule.map((week, idx) => {\n    if (week.runs.length <= 1) {\n      const runs = [...week.runs];\n      for (let i = 0; i < crossTrainingDays; i++) {\n        runs.splice(runs.length - 1, 0, {\n          type: \"cross\",\n          unit: week.unit,\n          mileage: 0,\n          targetPace: { unit: week.unit, pace: \"\" },\n          notes: \"Cross training\",\n        });\n      }\n      return { ...week, runs };\n    }\n\n    const easyRuns = week.runs.filter((r) => r.type === \"easy\");\n    const longRun = week.runs.find((r) => r.type === \"long\" || r.type === \"marathon\");\n    const tempoRun = week.runs.find((r) => r.type === \"tempo\");\n    const intervalRun = week.runs.find((r) => r.type === \"interval\");\n\n    const runs: PlannedRun[] = [];\n\n    switch (runsPerWeek) {\n      case 5:\n        if (easyRuns[0]) runs.push(easyRuns[0]);\n        if (easyRuns[1]) runs.push(easyRuns[1]);\n        else if (easyRuns[0]) runs.push({ ...easyRuns[0] });\n        if (tempoRun) runs.push(tempoRun);\n        if (intervalRun) runs.push(intervalRun);\n        if (longRun) runs.push(longRun);\n        break;\n      case 4:\n        if (easyRuns[0]) runs.push(easyRuns[0]);\n        if (tempoRun) runs.push(tempoRun);\n        if (intervalRun) runs.push(intervalRun);\n        if (longRun) runs.push(longRun);\n        break;\n      case 3:\n        if (easyRuns[0]) runs.push(easyRuns[0]);\n        if (longRun) runs.push(longRun);\n        const alt3 = idx % 2 === 0 ? intervalRun : tempoRun;\n        if (alt3) runs.push(alt3);\n        break;\n      case 2:\n        if (longRun) runs.push(longRun);\n        const alt2 = idx % 2 === 0 ? intervalRun : tempoRun;\n        if (alt2) runs.push(alt2);\n        break;\n    }\n\n    const longIndex = runs.findIndex((r) => r.type === \"long\" || r.type === \"marathon\");\n    const insertAt = longIndex === -1 ? runs.length : longIndex;\n    for (let i = 0; i < crossTrainingDays; i++) {\n      runs.splice(insertAt, 0, {\n        type: \"cross\",\n        unit: week.unit,\n        mileage: 0,\n        targetPace: { unit: week.unit, pace: \"\" },\n        notes: \"Cross training\",\n      });\n    }\n\n    const weeklyMileage = runs.reduce((tot, r) => tot + (r.mileage || 0), 0);\n\n    let notes = week.notes;\n    if (runsPerWeek < 4 && notes) {\n      notes = notes.replace(/\\s*-?\\s*Cutback\\b/i, \"\").trim();\n    }\n\n    return { ...week, runs, weeklyMileage, notes };\n  });\n\n  return { ...plan, schedule };\n}\n"],"mappings":"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","ignoreList":[]}