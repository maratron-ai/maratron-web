{"version":3,"names":["cov_9172r32as","actualCoverage","NextResponse","prisma","GET","_req","ctx","f","params","s","id","profile","socialProfile","findUnique","where","userId","include","user","select","name","avatarUrl","_count","runs","followers","following","posts","b","json","error","status","total","run","aggregate","_sum","distance","data","username","bio","createdAt","updatedAt","runCount","totalDistance","followerCount","followingCount","postCount","err","console"],"sources":["route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\";\nimport { prisma } from \"@lib/prisma\";\n\nexport async function GET(_req: NextRequest, ctx: { params: Promise<{ id: string }> }) {\n  const params = await ctx.params;\n  const { id } = params;\n  try {\n    const profile = await prisma.socialProfile.findUnique({\n      where: { userId: id },\n      include: {\n        user: {\n          select: { name: true, avatarUrl: true, _count: { select: { runs: true } } },\n        },\n        _count: { select: { followers: true, following: true, posts: true } },\n      },\n    });\n    if (!profile) return NextResponse.json({ error: \"Not found\" }, { status: 404 });\n\n    const total = await prisma.run.aggregate({\n      where: { userId: id },\n      _sum: { distance: true },\n    });\n\n    const data = {\n      id: profile.id,\n      userId: profile.userId,\n      username: profile.username,\n      bio: profile.bio,\n      avatarUrl: profile.user.avatarUrl,\n      createdAt: profile.createdAt,\n      updatedAt: profile.updatedAt,\n      name: profile.user.name,\n      runCount: profile.user._count.runs,\n      totalDistance: total._sum.distance ?? 0,\n      followerCount: profile._count.followers,\n      followingCount: profile._count.following,\n      postCount: profile._count.posts,\n    };\n\n    return NextResponse.json(data);\n  } catch (err) {\n    console.error(\"Error getting profile\", err);\n    return NextResponse.json({ error: \"Failed\" }, { status: 500 });\n  }\n}\n"],"mappings":"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","ignoreList":[]}