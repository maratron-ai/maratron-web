{"version":3,"names":["cov_1h5xln5xdx","actualCoverage","NextResponse","prisma","shoeSchema","GET","f","s","shoes","shoe","findMany","json","status","error","console","Error","b","message","POST","request","body","validate","abortEarly","stripUnknown","userId","name","notes","currentDistance","distanceUnit","maxDistance","retired","newShoe","create","data","user","connect","id","Number"],"sources":["route.ts"],"sourcesContent":["// src/app/api/shoes/route.ts\nimport { NextRequest, NextResponse } from \"next/server\";\nimport { prisma } from \"@lib/prisma\";\nimport { shoeSchema } from \"@lib/schemas/shoeSchema\";\n\nexport async function GET() {\n  try {\n    const shoes = await prisma.shoe.findMany();\n    return NextResponse.json(shoes, { status: 200 });\n  } catch (error) {\n    console.error(\"Error fetching shoes:\", error);\n    return NextResponse.json(\n      {\n        error: error instanceof Error ? error.message : \"Error fetching shoes\",\n      },\n      { status: 500 }\n    );\n  }\n}\n\nexport async function POST(request: NextRequest) {\n  try {\n    const body = await request.json();\n    await shoeSchema.validate(body, { abortEarly: false, stripUnknown: true });\n\n    const {\n      userId, // Always required; should come from auth/session in prod\n      name,\n      notes,\n      currentDistance,\n      distanceUnit,\n      maxDistance,\n      retired,\n    } = body;\n\n    if (!userId) {\n      return NextResponse.json(\n        { error: \"User ID is required\" },\n        { status: 400 }\n      );\n    }\n\n    const newShoe = await prisma.shoe.create({\n      data: {\n        user: { connect: { id: userId } },\n        name,\n        notes: notes || null,\n        currentDistance: currentDistance ? Number(currentDistance) : 0,\n        distanceUnit,\n        maxDistance: Number(maxDistance),\n        retired: !!retired,\n      },\n    });\n\n    return NextResponse.json(newShoe, { status: 201 });\n  } catch (error) {\n    console.error(\"Error creating shoe:\", error);\n    return NextResponse.json(\n      {\n        error: error instanceof Error ? error.message : \"Error creating shoe\",\n      },\n      { status: 500 }\n    );\n  }\n}\n"],"mappings":"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","ignoreList":[]}