{"version":3,"names":["_getJestObj","mock","useSession","jest","fn","_interopRequireDefault","require","_react","_react2","_userEvent","_ProfileSearch","_react3","_axios","_jsxFileName","__jsx","default","createElement","mockedSession","mockedAxios","axios","describe","beforeEach","clearAllMocks","it","mockReturnValue","data","render","limit","__self","__source","fileName","lineNumber","columnNumber","expect","screen","getByText","toBeInTheDocument","user","id","get","mockImplementation","url","includes","Promise","resolve","username","following","userEvent","setup","waitFor","toHaveBeenCalledWith","getByPlaceholderText","type","findByText","links","findAllByRole","name","toHaveTextContent"],"sources":["ProfileSearch.test.tsx"],"sourcesContent":["import \"@testing-library/jest-dom\";\nimport React from \"react\";\nimport { render, screen, waitFor } from \"@testing-library/react\";\nimport userEvent from \"@testing-library/user-event\";\nimport ProfileSearch from \"../social/ProfileSearch\";\nimport { useSession } from \"next-auth/react\";\nimport axios from \"axios\";\n\njest.mock(\"next-auth/react\", () => ({ useSession: jest.fn() }));\njest.mock(\"axios\");\n\nconst mockedSession = useSession as jest.Mock;\nconst mockedAxios = axios as jest.Mocked<typeof axios>;\n\ndescribe(\"ProfileSearch\", () => {\n  beforeEach(() => {\n    jest.clearAllMocks();\n  });\n\n  it(\"requires login\", () => {\n    mockedSession.mockReturnValue({ data: null });\n    render(<ProfileSearch limit={5} />);\n    expect(screen.getByText(/please log in/i)).toBeInTheDocument();\n  });\n\n  it(\"searches profiles\", async () => {\n    mockedSession.mockReturnValue({ data: { user: { id: \"u1\" } } });\n    mockedAxios.get.mockImplementation((url: string) => {\n      if (url.includes(\"/byUser/\")) {\n        return Promise.resolve({ data: { id: \"p1\" } });\n      }\n      if (url.includes(\"/search\")) {\n        return Promise.resolve({ data: [{ id: \"p2\", username: \"runner\" }] });\n      }\n      return Promise.resolve({ data: { following: false } });\n    });\n    const user = userEvent.setup();\n\n    render(<ProfileSearch limit={5} />);\n\n    await waitFor(() => expect(mockedAxios.get).toHaveBeenCalledWith(\"/api/social/profile/byUser/u1\"));\n    await waitFor(() => screen.getByPlaceholderText(/search runners/i));\n\n    await user.type(screen.getByPlaceholderText(/search runners/i), \"run\");\n\n    await waitFor(() =>\n      expect(mockedAxios.get).toHaveBeenCalledWith(\n        \"/api/social/search?q=run&profileId=p1\"\n      )\n    );\n    expect(await screen.findByText(/runner/)).toBeInTheDocument();\n  });\n\n  it(\"orders followed profiles first\", async () => {\n    mockedSession.mockReturnValue({ data: { user: { id: \"u1\" } } });\n    mockedAxios.get.mockImplementation((url: string) => {\n      if (url.includes(\"/byUser/\")) {\n        return Promise.resolve({ data: { id: \"p1\" } });\n      }\n      if (url.includes(\"/search\")) {\n        return Promise.resolve({\n          data: [\n            { id: \"p2\", username: \"first\" },\n            { id: \"p3\", username: \"second\" },\n          ],\n        });\n      }\n      return Promise.resolve({ data: { following: false } });\n    });\n    const user = userEvent.setup();\n\n    render(<ProfileSearch limit={5} />);\n\n    await waitFor(() =>\n      expect(mockedAxios.get).toHaveBeenCalledWith(\n        \"/api/social/profile/byUser/u1\"\n      )\n    );\n\n    await user.type(screen.getByPlaceholderText(/search runners/i), \"run\");\n\n    await waitFor(() =>\n      expect(mockedAxios.get).toHaveBeenCalledWith(\n        \"/api/social/search?q=run&profileId=p1\"\n      )\n    );\n\n    const links = await screen.findAllByRole(\"link\", { name: /first|second/ });\n    expect(links[0]).toHaveTextContent(/first/i);\n    expect(links[1]).toHaveTextContent(/second/i);\n  });\n});\n"],"mappings":"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","ignoreList":[]}